
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/jquery-ajax-unobtrusive/jquery.unobtrusive-ajax.js"></script>



@model MedBook.Models.ViewModels.ResearchVM

<h4 class="reference-content">Ввод данных исследования</h4>

<form asp-controller="Patient" asp-action="FindIndicator" data-ajax="true" data-ajax-method="post" data-ajax-mode="replace" data-ajax-update="#indicatorSearchList">
    <div>
        <table>
            <tr>
                <td class="text-label-head">Найти показатель </td>
                <td><input type="text" name="indicatorName" class="form-control" required /></td>
            </tr>
            <tr>
                <td class="text-label-head"></td>
                <td><input type="submit" value="Найти" class="btn btn-secondary" onclick="showIndicatorList()"/></td>
            </tr>
        </table><br />
    </div>
</form>

<div>
    <div id="indicatorSearchList"></div>
    <hr hidden id="manualIndicatorHR" />
</div>

<form asp-controller="Patient" asp-action="AddIndicatorToManualResearch" data-ajax="true" data-ajax-method="post" data-ajax-mode="replace" data-ajax-update="#manualResearchContainer">


    <div id="manualIndicatorVariants">
        <h4 id="manualIndicatorLabel" hidden>Значение</h4>
        <table id="manualIndicatorTable" hidden class="table">
            <tbody>
                <tr>
                    <td>Наименование </td>
                    <td><input class="form-control" readonly id="manualIndicatorName" name="manualIndicatorName" /></td>
                </tr>
                <tr>
                    <td>Значение </td>
                    <td><input id="manualIndicatorValue" class="form-control" required name="manualIndicatorValue" /></td>
                </tr>
                <tr>
                    <td>Ед. изм. </td>
                    <td><input id="manualIndicatorUnit" readonly class="form-control" name="manualIndicatorUnit" /></td>
                </tr>
            </tbody>
        </table>
        <input name="researchId" value="@Model.Id" hidden />
        <input id="indicatorId" name="indicatorId" hidden />
        <input type="submit" value="Добавить показатель" class="btn btn-secondary" id="addIndicatorBtn" onclick="hidePartialViews()" hidden/>
    </div>

</form>

<div id="manualResearchContainer"></div>

@*<script type="text/javascript">
    $(document).ready(function() {
        $('#addIndicatorBtn').click(function(e) {
            console.log('Run func');
            var indicator = {
                ResearchId: @ViewBag.Indicators.Id,
                Name: $('#manualIndicatorName').val(),
                Unit: $('#manualIndicatorUnit').val(),
                Value: $('#manualIndicatorValue').val(),
            };
            console.log(indicator);
            $.ajax({
                type: "POST",
                url: "@Url.Action("AddIndicatorToManualResearch","Patient")",
                data: indicator,
                contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                dataType: "html",
                failure: function(response) {
                    alert(response.responseText);
                },
                error: function(response) {
                    alert(response.responseText);
                }
            });
        })
    });
</script>*@
